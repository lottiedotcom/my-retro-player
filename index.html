<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Y2K Magic Scanner</title>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=VT323&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --glass-bg: linear-gradient(135deg, rgba(255,255,255,0.4), rgba(255,255,255,0.1));
            --border-light: rgba(255,255,255,0.6);
            --jelly-btn: linear-gradient(180deg, #ffccff 0%, #ff66b2 100%);
            --accent: #ff0099;
        }

        body {
            background: #ff99cc;
            background-image: 
                radial-gradient(circle at 20% 20%, #ffcce6 0%, transparent 20%),
                radial-gradient(circle at 80% 80%, #ccf2ff 0%, transparent 20%);
            background-size: 100% 100%;
            font-family: 'Fredoka', sans-serif;
            display: flex; flex-direction: column; align-items: center;
            padding: 10px; margin: 0; min-height: 100vh;
        }

        /* --- THE AESTHETIC PLAYER --- */
        #player-shell {
            width: 95%; max-width: 380px;
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border: 2px solid var(--border-light);
            border-radius: 20px;
            padding: 15px;
            box-shadow: 
                0 15px 35px rgba(255, 0, 153, 0.2),
                inset 0 0 20px rgba(255,255,255,0.3);
            position: relative;
            margin-bottom: 20px;
        }

        /* Top Bar */
        .status-bar {
            display: flex; justify-content: space-between;
            color: #fff; font-size: 12px; font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            margin-bottom: 10px;
            cursor: default;
        }

        /* The Screen */
        .screen-area {
            background: rgba(0,0,0,0.8);
            border-radius: 10px;
            padding: 10px;
            border: 2px solid rgba(255,255,255,0.2);
            margin-bottom: 15px;
        }

        /* Visualizer Bars */
        .viz-container {
            display: flex; gap: 3px; height: 30px; align-items: flex-end; margin-bottom: 5px;
        }
        .v-bar {
            flex: 1; background: linear-gradient(to top, #00ff00, #ccff00);
            border-radius: 2px;
            animation: bounce 0.5s infinite alternate;
        }
        .v-bar:nth-child(even) { animation-duration: 0.3s; }
        .v-bar:nth-child(odd) { animation-duration: 0.6s; }
        @keyframes bounce { 0% { height: 10%; } 100% { height: 100%; } }

        /* Song Info */
        .track-info {
            font-family: 'VT323', monospace; color: #00ff00; font-size: 20px;
            white-space: nowrap; overflow: hidden; text-shadow: 0 0 5px #00ff00;
        }
        
        /* Playlist List */
        .playlist-box {
            background: rgba(255,255,255,0.9);
            border-radius: 10px;
            height: 180px;
            overflow-y: auto;
            border: 2px inset rgba(255,255,255,0.5);
        }
        
        .pl-row {
            display: flex; padding: 8px; border-bottom: 1px dashed #ff99cc;
            font-size: 12px; color: #444; cursor: text; transition: 0.2s;
        }
        .pl-row:last-child { border-bottom: none; }
        .pl-row:hover { background: #fff0f5; }
        .pl-idx { width: 25px; color: var(--accent); font-weight: bold; }
        .pl-name { flex: 1; }
        .pl-time { font-family: 'VT323', monospace; font-size: 16px; color: #888; }

        /* Jelly Buttons */
        .controls {
            display: flex; justify-content: center; gap: 10px; margin-top: 15px;
        }
        .jelly-btn {
            width: 50px; height: 50px;
            border-radius: 50%; border: none;
            background: var(--jelly-btn);
            box-shadow: 0 5px 15px rgba(255, 102, 178, 0.4), inset 0 2px 5px rgba(255,255,255,0.8);
            color: white; font-size: 18px; cursor: pointer;
            transition: transform 0.1s;
        }
        .jelly-btn:active { transform: scale(0.9); }

        /* --- THE MAGIC TOOLS --- */
        #magic-tools {
            width: 95%; max-width: 380px;
            background: #fff; border-radius: 15px; padding: 20px;
            text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .upload-zone {
            border: 2px dashed #ff99cc; border-radius: 10px;
            padding: 20px; color: #ff66b2; font-weight: bold;
            margin-bottom: 10px; cursor: pointer;
            background: #fff0f5;
        }
        .upload-zone:hover { background: #ffe6f2; }
        
        #loading-msg { display: none; color: var(--accent); font-weight: bold; margin: 10px 0; }
        
        .action-btn {
            background: var(--accent); color: white; border: none;
            padding: 12px 20px; border-radius: 30px; font-weight: bold;
            font-size: 14px; width: 100%; cursor: pointer;
            box-shadow: 0 4px 10px rgba(255, 0, 153, 0.3);
        }

    </style>
</head>
<body>

<div id="player-shell">
    <div class="status-bar">
        <span>‚ú® iMusic Girl 2004</span>
        <span>‚ô• 100%</span>
    </div>

    <div class="screen-area">
        <div class="viz-container">
            <div class="v-bar"></div><div class="v-bar"></div><div class="v-bar"></div>
            <div class="v-bar"></div><div class="v-bar"></div><div class="v-bar"></div>
            <div class="v-bar"></div><div class="v-bar"></div><div class="v-bar"></div>
        </div>
        <div class="track-info" id="marquee">Waiting for playlist...</div>
    </div>

    <div class="playlist-box" id="pl-container">
        <div class="pl-row">
            <div class="pl-idx">1</div>
            <div class="pl-name" contenteditable="true">Upload a screenshot...</div>
            <div class="pl-time" contenteditable="true">0:00</div>
        </div>
        <div class="pl-row">
            <div class="pl-idx">2</div>
            <div class="pl-name" contenteditable="true">...and I will read it!</div>
            <div class="pl-time" contenteditable="true">0:00</div>
        </div>
    </div>

    <div class="controls">
        <button class="jelly-btn">‚èÆ</button>
        <button class="jelly-btn">‚ñ∂</button>
        <button class="jelly-btn">‚è≠</button>
    </div>
</div>

<div id="magic-tools">
    <h3 style="margin-top:0; color: #ff66b2;">üîÆ Magic Playlist Reader</h3>
    
    <div class="upload-zone" onclick="document.getElementById('img-upload').click()">
        üì∏ Tap to Upload Screenshot
        <p style="font-size:10px; opacity:0.7; margin:5px 0;">(Spotify, Apple Music, Notes)</p>
    </div>
    <input type="file" id="img-upload" accept="image/*" style="display:none" onchange="processImage(this)">
    
    <div id="loading-msg">‚ú® Scanning your image... (This takes a sec)</div>
    
    <button class="action-btn" onclick="saveImage()">üíæ Save Cute Image</button>
</div>

<script>
    // --- THE MAGIC SCANNER LOGIC ---
    function processImage(input) {
        if (!input.files || !input.files[0]) return;
        
        const file = input.files[0];
        const loading = document.getElementById('loading-msg');
        const container = document.getElementById('pl-container');
        
        loading.style.display = "block";
        loading.innerText = "‚ú® Reading text pixels...";

        // Use Tesseract.js to read the image
        Tesseract.recognize(
            file,
            'eng',
            { logger: m => console.log(m) } // Check console if stuck
        ).then(({ data: { text } }) => {
            loading.style.display = "none";
            
            // Clean up the text results
            const lines = text.split('\n').filter(line => {
                const l = line.trim();
                return l.length > 4 && !l.includes('%') && !l.includes(':'); // Try to filter out UI junk
            });

            // Build the new list
            container.innerHTML = "";
            
            if (lines.length === 0) {
                container.innerHTML = `<div style="padding:10px; color:pink;">Could not read text! Try a clearer screenshot :(</div>`;
                return;
            }

            // Update Marquee
            document.getElementById('marquee').innerText = "*** " + lines[0] + " ***";

            lines.forEach((line, i) => {
                // Random fake time
                const min = Math.floor(Math.random() * 3) + 2;
                let sec = Math.floor(Math.random() * 60);
                if (sec < 10) sec = "0" + sec;
                
                const row = `
                <div class="pl-row">
                    <div class="pl-idx">${i + 1}</div>
                    <div class="pl-name" contenteditable="true">${line}</div>
                    <div class="pl-time" contenteditable="true">${min}:${sec}</div>
                </div>`;
                container.innerHTML += row;
            });
        }).catch(err => {
            loading.innerText = "Error reading image :(";
            console.error(err);
        });
    }

    // --- SAVE IMAGE ---
    function saveImage() {
        const element = document.getElementById('player-shell');
        // Temporarily hide marquee animation for cleaner screenshot if needed
        html2canvas(element, { scale: 3, backgroundColor: null }).then(canvas => {
            let link = document.createElement("a");
            link.download = "my-cute-playlist.png";
            link.href = canvas.toDataURL("image/png");
            link.click();
        });
    }
</script>

</body>
</html>

